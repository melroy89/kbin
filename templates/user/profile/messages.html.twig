{% extends 'base.html.twig' %}

{% from '_layout/_not_found.html.twig' import not_found %}

{% block title %}{{ 'messages'|trans }}{% endblock %}

{% block body %}
    <div class="kbin-profile kbin-profile-threads-page">
        {% include 'user/profile/_tabs.html.twig' %}

        <div class="kbin-profile-edit mt-lg-4">
            {% if threads|length %}
                <div class="table-responsive">
                    <table class="table align-middle small">
                        <tbody>
                        {% for thread in threads %}
                            <tr>
                                <td class="{{ thread.countNewMessages(app.user) ? '' : 'opacity-50' }}">{{ block('message') }}</td>
                                <td class="text-end">
                                    <small class="text-muted">
                                        <time data-controller="timeago"
                                              data-timeago-refresh-interval-value="10000"
                                              data-timeago-datetime-value="{{ thread.updatedAt|date('c') }}">{{ thread.updatedAt|ago }}</time>
                                    </small>
                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>

                {% if(threads.haveToPaginate) %}
                    {{ pagerfanta(threads, null, {'pageParameter':'[p]'}) }}
                {% endif %}
            {% else %}
                {{ not_found() }}
            {% endif %}
        </div>
    </div>
{% endblock %}

{% block sidebar %}
    {% include 'user/_sidebar.html.twig' with {user: app.user} %}
    {% include 'user/profile/_sidebar.html.twig' %}
    {{ parent() }}
    <div class="mb-4">
        {% include 'user/_moderator_list_card.html.twig'with {user: app.user} %}
    </div>
{% endblock %}

{% block message %}
    {% from 'user/_macros.html.twig' import user %}

    {{ (thread.messages|length - 1)|format_number }} odpowiedzi w wÄ…tku z {{ user(thread.otherParticipants(app.user)[0]) }} -
    <strong><a href="{{ path('user_profile_message', {'id': thread.id}) }}">{{ thread.title }}</a></strong>
{% endblock message %}
